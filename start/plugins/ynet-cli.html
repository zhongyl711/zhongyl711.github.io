<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>脚手架 | Ynet-H5平台框架</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="Ynet-H5平台框架">
    
    <link rel="preload" href="/docs/assets/css/0.styles.94ae1aad.css" as="style"><link rel="preload" href="/docs/assets/js/app.a8b6816f.js" as="script"><link rel="preload" href="/docs/assets/js/2.9a338741.js" as="script"><link rel="preload" href="/docs/assets/js/20.84a44669.js" as="script"><link rel="prefetch" href="/docs/assets/js/10.84fb6d19.js"><link rel="prefetch" href="/docs/assets/js/11.598658e3.js"><link rel="prefetch" href="/docs/assets/js/12.970d0a49.js"><link rel="prefetch" href="/docs/assets/js/13.a1286195.js"><link rel="prefetch" href="/docs/assets/js/14.a19b6384.js"><link rel="prefetch" href="/docs/assets/js/15.54760aa1.js"><link rel="prefetch" href="/docs/assets/js/16.441bb57c.js"><link rel="prefetch" href="/docs/assets/js/17.8ef0c638.js"><link rel="prefetch" href="/docs/assets/js/18.62607bbf.js"><link rel="prefetch" href="/docs/assets/js/19.d209ac59.js"><link rel="prefetch" href="/docs/assets/js/21.95d79d29.js"><link rel="prefetch" href="/docs/assets/js/22.95e4b0d8.js"><link rel="prefetch" href="/docs/assets/js/23.5a4dd687.js"><link rel="prefetch" href="/docs/assets/js/24.0c18cac9.js"><link rel="prefetch" href="/docs/assets/js/25.40d8ba0d.js"><link rel="prefetch" href="/docs/assets/js/26.3d572dbc.js"><link rel="prefetch" href="/docs/assets/js/27.299b040d.js"><link rel="prefetch" href="/docs/assets/js/28.61546b37.js"><link rel="prefetch" href="/docs/assets/js/29.faad5132.js"><link rel="prefetch" href="/docs/assets/js/3.eb09cc22.js"><link rel="prefetch" href="/docs/assets/js/30.d7e3d7ca.js"><link rel="prefetch" href="/docs/assets/js/31.caa1a650.js"><link rel="prefetch" href="/docs/assets/js/32.c0a156ae.js"><link rel="prefetch" href="/docs/assets/js/33.de5c0526.js"><link rel="prefetch" href="/docs/assets/js/34.e658f871.js"><link rel="prefetch" href="/docs/assets/js/35.383b270a.js"><link rel="prefetch" href="/docs/assets/js/36.75323e51.js"><link rel="prefetch" href="/docs/assets/js/4.fad0cf3e.js"><link rel="prefetch" href="/docs/assets/js/5.edc7a992.js"><link rel="prefetch" href="/docs/assets/js/6.91e0bcc4.js"><link rel="prefetch" href="/docs/assets/js/7.b183d4f7.js"><link rel="prefetch" href="/docs/assets/js/8.c5f5de09.js"><link rel="prefetch" href="/docs/assets/js/9.3de77086.js">
    <link rel="stylesheet" href="/docs/assets/css/0.styles.94ae1aad.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/docs/" class="home-link router-link-active"><!----> <span class="site-name">Ynet-H5平台框架</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/docs/start/desc.html" class="nav-link">
  起步
</a></div><div class="nav-item"><a href="/docs/qa/qa.html" class="nav-link">
  常见问题
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/docs/start/desc.html" class="nav-link">
  起步
</a></div><div class="nav-item"><a href="/docs/qa/qa.html" class="nav-link">
  常见问题
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>起步</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>插件</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs/start/plugins/ynet-cli.html" aria-current="page" class="active sidebar-link">脚手架</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/start/plugins/ynet-cli.html#内置" class="sidebar-link">内置</a></li><li class="sidebar-sub-header"><a href="/docs/start/plugins/ynet-cli.html#命令说明" class="sidebar-link">命令说明</a></li><li class="sidebar-sub-header"><a href="/docs/start/plugins/ynet-cli.html#配置文件说明" class="sidebar-link">配置文件说明</a></li><li class="sidebar-sub-header"><a href="/docs/start/plugins/ynet-cli.html#如何扩展ynet脚手架插件" class="sidebar-link">如何扩展ynet脚手架插件</a></li><li class="sidebar-sub-header"><a href="/docs/start/plugins/ynet-cli.html#如何使用ynet脚手架插件" class="sidebar-link">如何使用ynet脚手架插件</a></li></ul></li><li><a href="/docs/start/plugins/ynet-babel-plugin-chunkname.html" class="sidebar-link">chunkName魔法注释</a></li><li><a href="/docs/start/plugins/ynet-copy-webpack.html" class="sidebar-link">copy文件复制</a></li><li><a href="/docs/start/plugins/ynet-utils.html" class="sidebar-link">工具方法库</a></li><li><a href="/docs/start/plugins/ynet-filter.html" class="sidebar-link">通用过滤器</a></li><li><a href="/docs/start/plugins/ynet-if-loader.html" class="sidebar-link">编译逻辑分支插件</a></li><li><a href="/docs/start/plugins/ynet-pxrem-loader.html" class="sidebar-link">rem单位转换插件</a></li><li><a href="/docs/start/plugins/ynet-local-storage.html" class="sidebar-link">localStorage持久化缓存</a></li><li><a href="/docs/start/plugins/ynet-session-storage.html" class="sidebar-link">sessionStorage会话缓存</a></li><li><a href="/docs/start/plugins/ynet-session-window.html" class="sidebar-link">window会话缓存</a></li><li><a href="/docs/start/plugins/ynet-request-axios.html" class="sidebar-link">axios请求处理</a></li><li><a href="/docs/start/plugins/ynet-request-mock.html" class="sidebar-link">mock请求处理</a></li><li><a href="/docs/start/plugins/ynet-types.html" class="sidebar-link">@ynet/type</a></li><li><a href="/docs/start/plugins/ynet-vconsole-plugin.html" class="sidebar-link">移动端调试控制台</a></li><li><a href="/docs/start/plugins/ynet-ui.html" class="sidebar-link">UI核心库</a></li><li><a href="/docs/start/plugins/ynet-validate.html" class="sidebar-link">校验库</a></li><li><a href="/docs/start/plugins/ynet-reinforce.html" class="sidebar-link">加固库</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="脚手架"><a href="#脚手架" class="header-anchor">#</a> 脚手架</h1> <p>Ynet-cli 是我们基于 webpack 进行定制化封装的脚手架项目</p> <p>我们对外提供的执行命令为：<strong>ynet</strong></p> <p>内部默认集成了常用的文件 loader 编译，和常规的插件</p> <h2 id="内置"><a href="#内置" class="header-anchor">#</a> 内置</h2> <h3 id="loader"><a href="#loader" class="header-anchor">#</a> loader</h3> <ol><li>typescript 文件</li> <li>js 文件</li> <li>less/css 样式文件</li> <li>vue 文件</li> <li>常见资源文件（图片、音频、视频等）</li></ol> <h3 id="内置的-plugins"><a href="#内置的-plugins" class="header-anchor">#</a> 内置的 plugins</h3> <ol><li>HtmlWebpackPlugin HTML 插件</li> <li>HotModuleReplacementPlugin 热重载</li></ol> <blockquote><p>我们内置了已经完善的 babel 转译规则及插件，无需关心 Babel 相关配置</p></blockquote> <h2 id="命令说明"><a href="#命令说明" class="header-anchor">#</a> 命令说明</h2> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  script<span class="token operator">:</span><span class="token punctuation">{</span>
    dev<span class="token operator">:</span><span class="token string">&quot;ynet --mode=development --config=build/dev.config.js&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>--model=development/production  该命令代表当前命令模式</p> <p>--config=***{path}*** 该命令配置打包配置文件地址，为当前打包做差异化配置</p></blockquote> <h2 id="配置文件说明"><a href="#配置文件说明" class="header-anchor">#</a> 配置文件说明</h2> <p>业务可以通过配置config.js 的方式来重写默认打包配置，在构建运行时，会将业务自定义的打包配置文件与下面的默认配置做合并处理</p> <h3 id="默认配置文件"><a href="#默认配置文件" class="header-anchor">#</a> 默认配置文件</h3> <p>app.config.js</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> resolve<span class="token punctuation">,</span> args <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./utils/common&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> TerserPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;terser-webpack-plugin&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> CssMinimizerPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;css-minimizer-webpack-plugin&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    compilerOption<span class="token operator">:</span> <span class="token punctuation">{</span>
        context<span class="token operator">:</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">&quot;src/&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        entry<span class="token operator">:</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span>
        output<span class="token operator">:</span> <span class="token punctuation">{</span>
            filename<span class="token operator">:</span> <span class="token string">&quot;[name].js&quot;</span><span class="token punctuation">,</span>
            path<span class="token operator">:</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">&quot;dist/&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            publicPath<span class="token operator">:</span> <span class="token string">&quot;/&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        resolve<span class="token operator">:</span> <span class="token punctuation">{</span>
            extensions<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;.ts&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;.js&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            alias<span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token string">&quot;~&quot;</span><span class="token operator">:</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">&quot;src&quot;</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        optimization<span class="token operator">:</span> <span class="token punctuation">{</span>
            splitChunks<span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token comment">// 代码块类型 必须三选一： 'initial'（初始化） | 'all'(默认就是all) | 'async'（动态加载）</span>
                chunks<span class="token operator">:</span> <span class="token string">&quot;initial&quot;</span><span class="token punctuation">,</span>
                <span class="token comment">// 最小尺寸，默认0</span>
                minSize<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
                <span class="token comment">// 最小 chunk ，默认1</span>
                minChunks<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                <span class="token comment">// 最大异步请求数， 默认1</span>
                maxAsyncRequests<span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
                <span class="token comment">// 最大初始化请求书，默认1</span>
                maxInitialRequests<span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
                <span class="token comment">// 名称，此选项课接收 function</span>
                <span class="token function-variable function">name</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token comment">// 缓存组会继承splitChunks的配置，但是test、priorty和reuseExistingChunk只能用于配置缓存组。</span>
                cacheGroups<span class="token operator">:</span> <span class="token punctuation">{</span>
                    ynet<span class="token operator">:</span> <span class="token punctuation">{</span>
                        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">[\\/]ynet[\\/]</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
                        priority<span class="token operator">:</span> <span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">,</span>
                        name<span class="token operator">:</span> <span class="token string">&quot;ynet&quot;</span>
                    <span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token comment">// 打包第三方库</span>
                    vendor<span class="token operator">:</span> <span class="token punctuation">{</span>
                        chunks<span class="token operator">:</span> <span class="token string">&quot;all&quot;</span><span class="token punctuation">,</span>
                        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">[\\/]node_modules[\\/]</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
                        priority<span class="token operator">:</span> <span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span>
                        name<span class="token operator">:</span> <span class="token string">&quot;vendor&quot;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            minimize<span class="token operator">:</span> args<span class="token punctuation">.</span>mode <span class="token operator">!==</span> <span class="token string">&quot;development&quot;</span><span class="token punctuation">,</span>
            minimizer<span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token keyword">new</span> <span class="token class-name">CssMinimizerPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token keyword">new</span> <span class="token class-name">TerserPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                    terserOptions<span class="token operator">:</span> <span class="token punctuation">{</span>
                        safari10<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
                        ie8<span class="token operator">:</span> <span class="token boolean">false</span>
                    <span class="token punctuation">}</span><span class="token punctuation">,</span>
                    extractComments<span class="token operator">:</span> <span class="token boolean">false</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span>
            <span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    webpackServer<span class="token operator">:</span> <span class="token punctuation">{</span>
        enable<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        option<span class="token operator">:</span> <span class="token punctuation">{</span>
            host<span class="token operator">:</span> <span class="token string">&quot;local-ip&quot;</span><span class="token punctuation">,</span>
            port<span class="token operator">:</span> <span class="token number">8080</span><span class="token punctuation">,</span>
            hot<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            proxy<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            open<span class="token operator">:</span> <span class="token boolean">true</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    globalDefine<span class="token operator">:</span> <span class="token punctuation">{</span>
        ynet_process_loglevel<span class="token operator">:</span> <span class="token string">&quot;'all'&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    extendPlugin<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    ynetLoaderOptions<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token comment">// less-loader的配置项</span>
        lessLoaderOptions<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

</code></pre></div><ul><li>compilerOption 对应webpack的compilerOption，详细介绍请查询webpakc compilerOption</li> <li>webpackServer 为是否启动webpackServer， 其中enable 为启动开关，option为配置参数，配置参数可参考webpacserver插件配置</li> <li>globalDefine，ynet脚手架默认开启了DefinePlugin功能，可通过该属性扩展全局属性</li> <li>extendPlugin 为ynet自定义插件列表，详细内容查看下方extendPlugin介绍</li> <li>ynetLoaderOptions 为各种loader配置项，目前只增加了lessLoaderOptions，用于配置less选项，后续根据项目需求再开放其他loader配置项</li></ul> <h2 id="如何扩展ynet脚手架插件"><a href="#如何扩展ynet脚手架插件" class="header-anchor">#</a> 如何扩展ynet脚手架插件</h2> <p>我们定义了一套规范来约束ynet教授兼插件，包括后续的三方插件，也必须按照此规范做为此封装，然后进行使用，方便后续ynet对所有依赖插件的依赖分析</p> <h3 id="创建ynet-cli-js"><a href="#创建ynet-cli-js" class="header-anchor">#</a> 创建ynet-cli.js</h3> <p>在根目录下创建<strong>ynet-cli.js</strong>文件</p> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">webpackConfig<span class="token punctuation">,</span> appConfig<span class="token punctuation">,</span> extendWebpackConfig<span class="token punctuation">,</span> pluginArgs</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   	<span class="token comment">//在此进行扩展</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

</code></pre></div><h4 id="参数说明"><a href="#参数说明" class="header-anchor">#</a> 参数说明</h4> <ul><li><p>webpackConfig： 原始webpackConfig配置</p></li> <li><p>appConfig：当前打包配置文件，请参考<strong>app.config.js</strong></p></li> <li><p>extendWebpackConfig：webpack-chain操作把柄，详细介绍请参考：<strong>webpack-chain</strong></p></li> <li><p>pluginArgs：当前插件的参数</p></li></ul> <h2 id="如何使用ynet脚手架插件"><a href="#如何使用ynet脚手架插件" class="header-anchor">#</a> 如何使用ynet脚手架插件</h2> <p>首先需要在项目中添加当前插件的依赖，yarn add xxx</p> <p>在打包配置文件中的extendPlugin添加该插件</p> <p>例如：</p> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
	extendPlugin<span class="token operator">:</span><span class="token punctuation">[</span>
       <span class="token punctuation">[</span>
            <span class="token string">&quot;@ynet/pxrem-loader&quot;</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token comment">//对应比例，750px设计稿</span>
                remUnit<span class="token operator">:</span> <span class="token number">37.5</span><span class="token punctuation">,</span>
                <span class="token comment">//转化成rem时保留的小数位</span>
                remPrecision<span class="token operator">:</span> <span class="token number">8</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token string">&quot;@ynet/if-loader&quot;</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>如果当前组件需要传递参数时，则将该插件作为数组项，数组内第一个参数为组件名称，第二个参数为当前组件的参数信息</p></blockquote></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/docs/start/DI.html" class="prev">
        依赖注入
      </a></span> <span class="next"><a href="/docs/start/plugins/ynet-babel-plugin-chunkname.html">
        chunkName魔法注释
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/docs/assets/js/app.a8b6816f.js" defer></script><script src="/docs/assets/js/2.9a338741.js" defer></script><script src="/docs/assets/js/20.84a44669.js" defer></script>
  </body>
</html>
